import pandas as pd
import re

def extract_metrics(data_dict):
    df_rows = {}
    df_max_rows = {}

    for name, df in data_dict.items():
        # Use re.search to allow name to appear anywhere in the string
        match = re.search(r'modelchk_(-?\d+(?:\.\d+)?)_NC.*slit_(-?\d+(?:\.\d+)?)', name)
        if not match:
            continue  # Skip if name doesn't match expected format

        row_index = f"modelchk_{match.group(1)}_NC"
        col_name = f"slit_{match.group(2)}"

        # Extract values (from index 1)
        rmse_value = df.at[1, 'RMSE'] if 1 in df.index else None
        max_value = df.at[1, 'MAX'] if 1 in df.index else None

        # Initialize row if needed
        if row_index not in df_rows:
            df_rows[row_index] = {}
            df_max_rows[row_index] = {}

        df_rows[row_index][col_name] = rmse_value
        df_max_rows[row_index][col_name] = max_value

    # Convert to DataFrames
    df_result = pd.DataFrame.from_dict(df_rows, orient='index').sort_index().sort_index(axis=1)
    df_max_result = pd.DataFrame.from_dict(df_max_rows, orient='index').sort_index().sort_index(axis=1)

    return df_result, df_max_result